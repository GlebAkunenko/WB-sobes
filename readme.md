# Тестовое задание

## Описание
Данный проект представляет собой node.js сервер выполняющий запросы к API WB для получения тарифов коробов с последующим сохранением данных в google таблицу и базу данных.

## Подготовка

### Создание таблицы
Перейдите по [ссылке](https://docs.google.com/spreadsheets/d/13ND5uQtRtWORIF-o7BMCwWXR4Yv82ug9zhcl5y0wYEo/edit?usp=sharing) на таблицу-шаблон, нажмите `Файл` -> `Создать копию`. 

URL табилцы построен по следующему принципу: `https://docs.google.com/spreadsheets/d/<ID таблицы>/edit?gid=0#gid=`. `<ID таблицы>` необходимо запомнить.

Далее необходимо создать проект в [Google Cloud Console](https://console.cloud.google.com/). В этом проекте в поиске вбивает `Sheets Api`. Нажимаем `Enable`/`Manage`, перейдите на страницу сервиса. Слева в меню переходим в `Credentials`. Ниже таблица `Service Account`. Создаём новый аккаунт, Permissions: Basic -> Editor.
Создаём ключ доступа. 3 точки справа от аккаунта в таблице -> `Manage keys` -> `Add key` -> `Create new key` -> `JSON`. В результате получаем JSON файл, копируем почку сервисного аккаунта.

Переходим в скопированную Google таблицу. В настройках доступа добавляем email созданного сервисного аккаунта, как редактора.

### Настройка проекта
Используя Windows PowerShell
```
git clone https://github.com/GlebAkunenko/WB-sobes.git
cd .\WB-sobes\
cp .\example.env .env 
```
На других ОС, необходимо проделать аналогичные инструкции.

В файле `.env` заполнить необходимые переменные, в частности:
- `WB_TOKEN` токен для работы с WB API; 
- `SHEET_ID` то самое `<ID таблицы>` из URL;
- `GOOGLE_SHEETS_API_KEY_PATH` путь к JSON файлу с ключом доступа к сервисному аккаунту гугла. Лучше всего скопировать в директорию и просто указать имя файла.
- используя `POSTGRES_EXTERNAL_PORT` есть возможность подключиться к БД извне.

### Запуск

```
docker compose up
```
